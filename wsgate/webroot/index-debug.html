<!DOCTYPE html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>FreeRDP WebConnect</title>
    <meta name="description" content="A HTM5 based RDP client">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="css/style%JSDEBUG%.css">
    <script language="javascript" type="text/javascript">
        var wsBase = "%WSURI%";
    </script>
    <script src="js/modernizr%JSDEBUG%.js"></script>
    <script src="js/mootools%JSDEBUG%.js"></script>
    <script src="js/wsgate%JSDEBUG%.js"></script>
</head>
<body>
    <canvas id="screen" width="1024px" height="768px">
    <strong>Sorry, It looks as though your browser does not support the canvas tag...</strong> If you can, I suggest that you try Chrome or Safari.
    </canvas>

    <form>
        <fieldset>
            <legend>Session parameters:</legend>
            <label for="host">Hostname:</label>
            <input id="rdphost" type="text" name="host" value="%COOKIE_LASTHOST%" />
            <label for="user">User:</label>
            <input id="rdpuser" type="text" name="user" value="%COOKIE_LASTUSER%" />
            <label for="pass">Password:</label>
            <input id="rdppass" type="password" name="pass" value="%COOKIE_LASTPASS%" />
            <input id="rdpconnect" type="button" value="Connect" />
        </fieldset><!-- DEBUG -->
        <input id="echotest" type="button" value="Echo Test" />
        <input id="speedtest" type="button" value="Speed Test" /><!-- /DEBUG -->
    </form>

    <script language="javascript" type="text/javascript">
        function init() {/* DEBUG */
            document.id("echotest").addEvent("click", EchoTest);
            document.id("speedtest").addEvent("click", SpeedTest);/* /DEBUG */
            document.id("rdpconnect").addEvent('click', RDPrun);
        }
/* DEBUG */
function EchoTest() {
    wsUri = wsBase + '?mode=echo';
    var etest = new wsgate.EchoTest(wsUri);
    etest.Run();
}

function SpeedTest() {
    wsUri = wsBase + '?mode=speed';
    var stest = new wsgate.SpeedTest(wsUri, 1 * 1048576, 20);
    stest.Run();
}

/* /DEBUG */
function RDPrun() {
    wsUri = wsBase
        + '?host=' + document.id('rdphost').value
        + '&user=' + document.id('rdpuser').value
        + '&pass=' + document.id('rdppass').value
        + '&mode=rdp';
    var rdp = new wsgate.RDP(wsUri, document.getElementById('screen'));
    rdp.addEvent('alert', function(msg) { alert(msg); });
    rdp.addEvent('connected', function() {
            button = document.id("rdpconnect");
            button.removeEvents();
            button.value = 'Disconnect';
            button.addEvent('click', rdp.Disconnect.bind(rdp));

    });
    rdp.addEvent('disconnected', function() {
            button = document.id("rdpconnect");
            button.removeEvents();
            button.value = 'Connect';
            button.addEvent('click', RDPrun);

    });
    rdp.Run();
}

window.addEventListener("load", init, false);
</script>
</body>
</html> 
